<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>SPIFFSNVS.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link id="favicon" rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="tiapistylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="100%">
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border="0" src="tilogo.gif" /></a></td>
  <td bgcolor="red"><img src="titagline.gif" /></td>
</tr>
</table>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2298ed0e5bfee6f293aea6c715ac7f7c.html">exports</a></li><li class="navelem"><a class="el" href="dir_1395dc6568e73d67e90e363c4035e4f6.html">tidrivers_msp432</a></li><li class="navelem"><a class="el" href="dir_2ad5680906f12c9eddf121ba68442a90.html">source</a></li><li class="navelem"><a class="el" href="dir_990d0f34dc2cacbb7193d67ebfa91a5f.html">third_party</a></li><li class="navelem"><a class="el" href="dir_59dc67e6f6faf11b97b812c7bc9da806.html">spiffs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SPIFFSNVS.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module to enable the SPI Flash File System (SPIFFS) on the TI NVS driver. </p>
<hr/>
<p>The SPIFFSNVS header file should be included in an application as follows: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_s_p_i_f_f_s_n_v_s_8h.html">third_party/spiffs/SPIFFSNVS.h</a>&gt;</span></div></div><!-- fragment --><p>SPIFFSNVS is designed to provide interface functions required by the SPIFFS to read/write/erase NOR flash memory. These functions are implemented using the TI NVS driver. By leveraging the NVS driver, application code using SPIFFS is not tied to a physical memory type (like SPI flash). The NVS driver abstracts the physical memory interface so SPIFFS application code can run on any NVS driver instance. Changing between internal flash or external SPI flash can be done by having SPIFFS use a different NVS driver instance. SPIFFS will operate within the memory region which has been allocated for the NVS driver instance.</p>
<p>It is highly recommended that you read SPIFFS design and usage documentation before using SPIFFS. Documentation available here: <a href="https://github.com/pellepl/spiffs">https://github.com/pellepl/spiffs</a></p>
<h2>Using SPIFFS and SPIFFSNVS</h2>
<p>To mount a SPIFFS file system some configuration parameters and RAM must be provided at runtime (all sizes in bytes):</p><ul>
<li>physical block size (also known as sector size)</li>
<li>amount of memory allocated for SPIFFS</li>
<li>logical block size</li>
<li>logical page size</li>
<li>A RAM work buffer</li>
<li>A RAM file descriptor cache</li>
<li>A RAM read/write cache</li>
</ul>
<p>NVS drivers are aware of the physical block size and the amount of memory allocated (values are set in driver configuration; see board files). The logical block size must be an integer multiple of the physical block size (a.k.a. sector size): logicalBlockSize = n * physicalBlockSize</p>
<dl class="section note"><dt>Note</dt><dd>It is recommended to set logical block size equal to the physical block size when starting with SPIFFS. This can be changed later when optimizing the file system for your application.</dd></dl>
<p>The logical block size must also be an integer multiple of the logical page size: logicalBlockSize = i * logicalPageSize</p>
<p>A statically allocated RAM work buffer must be provided. This buffer must be (2 * logicalPageSize) in length. A statically allocated RAM file descriptor cache must also be provided. File descriptors are 44 bytes for the default SPIFFS configuration. The cache must be large enough to store as many file descriptors as desired. Start with 4 file descriptors and modify when optimizing for your application. Finally, SPIFFS requires a read/write cache be provided. Start with a (2 * logicalPageSize) size cache; this can be increased or reduced later.</p>
<p>As an example assume that we want to use SPIFFS with a NVS driver instance that has 128k of memory and the the physical block size is 4096 bytes. In this case the logical block size can be set to 8192 bytes (16 logical blocks). Now we can set the logical page size to 256 bytes (32 logical pages per logical block).</p>
<dl class="section note"><dt>Note</dt><dd>SPIFFS always keeps 2 logical blocks free; in the example above there would only be 14 logical blocks available for storage (16k is unusable). The logical block size can be reduced to have more space for data. The logical block size and logical page size should be changed to optimize the file system for your application.</dd></dl>
<p>Knowing the logical block and logical page sizes desired; <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a> must be used to initialize the <a class="el" href="structspiffs__config.html">spiffs_config</a> <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a> structures. <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a> requires a <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> object be provided. This object is used by SPIFFSNVS when reading/writing to flash memory. It also stores references to OS objects used for thread safety. Each SPIFFS file system instance must have it's own <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> object and these objects must reside in persistent memory (not on a task stack or memory lost during low power modes). The <a class="el" href="structspiffs__t.html#a00dfd42d670514d50b7a906b75e45a44">spiffs.user_data</a> field is used to store a pointer to its respective <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> object. Users must not change <a class="el" href="structspiffs__config.html">spiffs_config</a> and <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a> structures after <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a> has been called.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define SPIFFS_LOGICAL_BLOCK_SIZE    (4096)</span></div><div class="line"><span class="preprocessor">#define SPIFFS_LOGICAL_PAGE_SIZE     (128)</span></div><div class="line"><span class="preprocessor">#define SPIFFS_FILE_DESCRIPTOR_SIZE  (44)</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> uint8_t spiffsWorkBuffer[SPIFFS_LOGICAL_PAGE_SIZE * 2];</div><div class="line"><span class="keyword">static</span> uint8_t spiffsFileDescriptorCache[SPIFFS_FILE_DESCRIPTOR_SIZE * 4];</div><div class="line"><span class="keyword">static</span> uint8_t spiffsReadWriteCache[SPIFFS_LOGICAL_PAGE_SIZE * 2];</div><div class="line"></div><div class="line"><a class="code" href="structspiffs__t.html">spiffs</a>           fs;</div><div class="line"><a class="code" href="structspiffs__config.html">spiffs_config</a>    fsConfig;</div><div class="line">SPIFFSNVS_Object spiffsnvs;</div><div class="line"></div><div class="line">status = <a class="code" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48">SPIFFSNVS_config</a>(&amp;spiffsnvs, Board_NVSINTERNAL, &amp;fs, &amp;fsConfig,</div><div class="line">    SPIFFS_LOGICAL_BLOCK_SIZE, SPIFFS_LOGICAL_PAGE_SIZE);</div><div class="line"> <span class="keywordflow">if</span> (status != <a class="code" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga44e1652f2eb8528bf93adc77e3e013d6">SPIFFSNVS_STATUS_SUCCESS</a>) {</div><div class="line">     <span class="comment">// Handle error condition...</span></div><div class="line"> }</div><div class="line"></div><div class="line">status = <a class="code" href="spiffs_8h.html#a16d6f29a836803993d12b0f51e81a1e0">SPIFFS_mount</a>(&amp;fs, &amp;fsConfig, spiffsWorkBuffer,</div><div class="line">    spiffsFileDescriptorCache, <span class="keyword">sizeof</span>(spiffsFileDescriptorCache),</div><div class="line">    spiffsReadWriteCache, <span class="keyword">sizeof</span>(spiffsReadWriteCache), NULL);</div></div><!-- fragment --><h2>Logical block and page size restrictions on CC13XX and CC26XX devices</h2>
<p>Flash memory on CC13XX and CC26XX devices is divided into rows of 128 or 256 bytes (refer to datasheet for exact size). These rows can support up to 83 write operations before suffering effects of row disturb in which data can be corrupted. Setting the logical page size very small or setting the logical block size too large can lead to many logical pages in a logical block. Normal use and updates to pages can cause more than 83 write operations on a logical block's index page (first page in the logical block). The following conditions must be followed to prevent exceeding the 83 write limit:</p>
<ul>
<li>Select a logical page size that is equal to or an integer multiple of the device's physical row size (i.e. 128 or 256). Next select a logical block size to ensure the amount of logical pages in a logical block does not exceed 32: (logicalBlockSize / logicalPageSize &lt;= 32).</li>
</ul>
<p>It is the user's responsibility to make sure the logical page size is equal to or an integer multiple of the physical row size. SPIFFSNVS_init() will verify and return <a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga21872212b529e6a1157b6f3f4e579dbe" title="An error status code returned by SPIFFSNVS_config() ">SPIFFSNVS_STATUS_INV_PAGE_SIZE</a> if the amount of logical pages in a logical block is &gt; 32. </p>
</div><div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;spiffs_config.h&quot;</code><br />
<code>#include &quot;<a class="el" href="spiffs_8h_source.html">spiffs.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="_n_v_s_8h_source.html">ti/drivers/NVS.h</a>&gt;</code><br />
<code>#include &lt;ti/drivers/dpl/MutexP.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for SPIFFSNVS.h:</div>
<div class="dyncontent">
<div class="center"><img src="_s_p_i_f_f_s_n_v_s_8h__incl.png" border="0" usemap="#_s_p_i_f_f_s_n_v_s_8h" alt=""/></div>
<map name="_s_p_i_f_f_s_n_v_s_8h" id="_s_p_i_f_f_s_n_v_s_8h">
<area shape="rect" id="node4" href="spiffs_8h.html" title="spiffs.h" alt="" coords="21,80,86,107"/>
<area shape="rect" id="node5" href="_n_v_s_8h.html" title="Non&#45;Volatile Storage driver interface. " alt="" coords="212,80,327,107"/>
</map>
</div>
</div>
<p><a href="_s_p_i_f_f_s_n_v_s_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_p_i_f_f_s_n_v_s___lock__.html">SPIFFSNVS_Lock_</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPIFFSNVS Lock.  <a href="struct_s_p_i_f_f_s_n_v_s___lock__.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_p_i_f_f_s_n_v_s___data__.html">SPIFFSNVS_Data_</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPIFFSNVS data object.  <a href="struct_s_p_i_f_f_s_n_v_s___data__.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga44e1652f2eb8528bf93adc77e3e013d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga44e1652f2eb8528bf93adc77e3e013d6">SPIFFSNVS_STATUS_SUCCESS</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="memdesc:ga44e1652f2eb8528bf93adc77e3e013d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Successful status code returned by: <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a>  <a href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga44e1652f2eb8528bf93adc77e3e013d6">More...</a><br /></td></tr>
<tr class="separator:ga44e1652f2eb8528bf93adc77e3e013d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga24d6594e8daac912958ef381ffd60763"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga24d6594e8daac912958ef381ffd60763">SPIFFSNVS_STATUS_ERROR</a>&#160;&#160;&#160;(-1)</td></tr>
<tr class="memdesc:ga24d6594e8daac912958ef381ffd60763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic error status code returned by: <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a>  <a href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga24d6594e8daac912958ef381ffd60763">More...</a><br /></td></tr>
<tr class="separator:ga24d6594e8daac912958ef381ffd60763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaed3fec880853b3df3ddc6f2bd171f86"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#gaaed3fec880853b3df3ddc6f2bd171f86">SPIFFSNVS_STATUS_INV_NVS_IDX</a>&#160;&#160;&#160;(-2)</td></tr>
<tr class="memdesc:gaaed3fec880853b3df3ddc6f2bd171f86"><td class="mdescLeft">&#160;</td><td class="mdescRight">An error status code returned by <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a>  <a href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#gaaed3fec880853b3df3ddc6f2bd171f86">More...</a><br /></td></tr>
<tr class="separator:gaaed3fec880853b3df3ddc6f2bd171f86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7961506209d7c5a1dc791159d6c52a51"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga7961506209d7c5a1dc791159d6c52a51">SPIFFSNVS_STATUS_INV_BLOCK_SIZE</a>&#160;&#160;&#160;(-3)</td></tr>
<tr class="memdesc:ga7961506209d7c5a1dc791159d6c52a51"><td class="mdescLeft">&#160;</td><td class="mdescRight">An error status code returned by <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a>  <a href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga7961506209d7c5a1dc791159d6c52a51">More...</a><br /></td></tr>
<tr class="separator:ga7961506209d7c5a1dc791159d6c52a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21872212b529e6a1157b6f3f4e579dbe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga21872212b529e6a1157b6f3f4e579dbe">SPIFFSNVS_STATUS_INV_PAGE_SIZE</a>&#160;&#160;&#160;(-4)</td></tr>
<tr class="memdesc:ga21872212b529e6a1157b6f3f4e579dbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">An error status code returned by <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48" title="Initializes spiffs, spiffs_config and SPIFFSNVS_Data structures for SPIFFS to interface with the NVS ...">SPIFFSNVS_config()</a>  <a href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga21872212b529e6a1157b6f3f4e579dbe">More...</a><br /></td></tr>
<tr class="separator:ga21872212b529e6a1157b6f3f4e579dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7cf3f1a05b93a1ab7433d42bb2bafc4f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_s_p_i_f_f_s_n_v_s___lock__.html">SPIFFSNVS_Lock_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a7cf3f1a05b93a1ab7433d42bb2bafc4f">SPIFFSNVS_Lock</a></td></tr>
<tr class="memdesc:a7cf3f1a05b93a1ab7433d42bb2bafc4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPIFFSNVS Lock.  <a href="#a7cf3f1a05b93a1ab7433d42bb2bafc4f">More...</a><br /></td></tr>
<tr class="separator:a7cf3f1a05b93a1ab7433d42bb2bafc4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c955949f2948a593abf50454c1dada9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_s_p_i_f_f_s_n_v_s___data__.html">SPIFFSNVS_Data_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9">SPIFFSNVS_Data</a></td></tr>
<tr class="memdesc:a4c955949f2948a593abf50454c1dada9"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPIFFSNVS data object.  <a href="#a4c955949f2948a593abf50454c1dada9">More...</a><br /></td></tr>
<tr class="separator:a4c955949f2948a593abf50454c1dada9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad200c9f25659779041c17893b0155a48"><td class="memItemLeft" align="right" valign="top">s32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#ad200c9f25659779041c17893b0155a48">SPIFFSNVS_config</a> (<a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9">SPIFFSNVS_Data</a> *spiffsnvsData, u32_t nvsIndex, <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a> *fs, <a class="el" href="structspiffs__config.html">spiffs_config</a> *fsConfig, u32_t logicalBlockSize, u32_t logicalPageSize)</td></tr>
<tr class="memdesc:ad200c9f25659779041c17893b0155a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a>, <a class="el" href="structspiffs__config.html">spiffs_config</a> and <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> structures for SPIFFS to interface with the NVS driver.  <a href="#ad200c9f25659779041c17893b0155a48">More...</a><br /></td></tr>
<tr class="separator:ad200c9f25659779041c17893b0155a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a7cf3f1a05b93a1ab7433d42bb2bafc4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf3f1a05b93a1ab7433d42bb2bafc4f">&sect;&nbsp;</a></span>SPIFFSNVS_Lock</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_s_p_i_f_f_s_n_v_s___lock__.html">SPIFFSNVS_Lock_</a>  <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a7cf3f1a05b93a1ab7433d42bb2bafc4f">SPIFFSNVS_Lock</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SPIFFSNVS Lock. </p>
<p>Lock mechanism to ensure thread safety. </p>

</div>
</div>
<a id="a4c955949f2948a593abf50454c1dada9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c955949f2948a593abf50454c1dada9">&sect;&nbsp;</a></span>SPIFFSNVS_Data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_s_p_i_f_f_s_n_v_s___data__.html">SPIFFSNVS_Data_</a>  <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9">SPIFFSNVS_Data</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SPIFFSNVS data object. </p>
<p>Memory required to store the NVS handle used to read/write memory and the locking mechanism used to provide thread safety to SPIFFS. Each SPIFFS file system must have it's own SPIFFSNVS_Data object and it must be persistent. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad200c9f25659779041c17893b0155a48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad200c9f25659779041c17893b0155a48">&sect;&nbsp;</a></span>SPIFFSNVS_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s32_t SPIFFSNVS_config </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9">SPIFFSNVS_Data</a> *&#160;</td>
          <td class="paramname"><em>spiffsnvsData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32_t&#160;</td>
          <td class="paramname"><em>nvsIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a> *&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structspiffs__config.html">spiffs_config</a> *&#160;</td>
          <td class="paramname"><em>fsConfig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32_t&#160;</td>
          <td class="paramname"><em>logicalBlockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32_t&#160;</td>
          <td class="paramname"><em>logicalPageSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a>, <a class="el" href="structspiffs__config.html">spiffs_config</a> and <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> structures for SPIFFS to interface with the NVS driver. </p>
<p>This function initializes fields in the <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a>, <a class="el" href="structspiffs__config.html">spiffs_config</a> and <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> structures to enable SPIFFS to interface with a NVS driver instance. This function performs the following actions:</p><ol type="1">
<li>Opens the TI NVS driver instance</li>
<li>Verifies valid logical block and logical page sizes are used</li>
<li>Creates a lock used by SPIFFS for thread-safety</li>
<li>Sets fields in <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a>, <a class="el" href="structspiffs__config.html">spiffs_config</a> and <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> structures to enable SPIFFS to use the TI NVS as the interface to flash memory.</li>
</ol>
<p>The <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a> and <a class="el" href="structspiffs__config.html">spiffs_config</a> structures are used to mount the file system. This function must be called only once for each SPIFFS instance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spiffsnvsData</td><td>Pointer to a <a class="el" href="_s_p_i_f_f_s_n_v_s_8h.html#a4c955949f2948a593abf50454c1dada9" title="SPIFFSNVS data object. ">SPIFFSNVS_Data</a> structure</td></tr>
    <tr><td class="paramname">nvsIndex</td><td>Index of the NVS driver to be used to read/write flash memory.</td></tr>
    <tr><td class="paramname">fs</td><td>Pointer to a <a class="el" href="spiffs_8h.html#ad770b2e1589c193b8e39b6335e48e32e">spiffs</a> file system object</td></tr>
    <tr><td class="paramname">fsConfig</td><td>Pointer to a <a class="el" href="structspiffs__config.html">spiffs_config</a> structure</td></tr>
    <tr><td class="paramname">logicalBlockSize</td><td>Logical block size in bytes</td></tr>
    <tr><td class="paramname">logicalPageSize</td><td>Logical page size in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga44e1652f2eb8528bf93adc77e3e013d6" title="Successful status code returned by: SPIFFSNVS_config() ">SPIFFSNVS_STATUS_SUCCESS</a> if structures were configured correctly. </dd>
<dd>
<a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#gaaed3fec880853b3df3ddc6f2bd171f86" title="An error status code returned by SPIFFSNVS_config() ">SPIFFSNVS_STATUS_INV_NVS_IDX</a> if an invalid index is used. </dd>
<dd>
<a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga7961506209d7c5a1dc791159d6c52a51" title="An error status code returned by SPIFFSNVS_config() ">SPIFFSNVS_STATUS_INV_BLOCK_SIZE</a> if an invalid logical block size is used. </dd>
<dd>
<a class="el" href="group___s_p_i_f_f_s_n_v_s___s_t_a_t_u_s.html#ga21872212b529e6a1157b6f3f4e579dbe" title="An error status code returned by SPIFFSNVS_config() ">SPIFFSNVS_STATUS_INV_PAGE_SIZE</a> if an invalid logical page size is used. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><small>
  <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2019</a>, Texas Instruments Incorporated. All rights reserved. <br>
  <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>
</small>
</body>
</html>
