<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>SPIMSP432DMA.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link id="favicon" rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="tiapistylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="100%">
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border="0" src="tilogo.gif" /></a></td>
  <td bgcolor="red"><img src="titagline.gif" /></td>
</tr>
</table>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2298ed0e5bfee6f293aea6c715ac7f7c.html">exports</a></li><li class="navelem"><a class="el" href="dir_1395dc6568e73d67e90e363c4035e4f6.html">tidrivers_msp432</a></li><li class="navelem"><a class="el" href="dir_2ad5680906f12c9eddf121ba68442a90.html">source</a></li><li class="navelem"><a class="el" href="dir_0da705fc44f28017c66964e8e9f342d2.html">ti</a></li><li class="navelem"><a class="el" href="dir_5cee8d03ec8e05f2dc78c474d8f4ba05.html">drivers</a></li><li class="navelem"><a class="el" href="dir_598b773727c07b25342b386f5e5ac11d.html">spi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">SPIMSP432DMA.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SPI driver implementation for a EUSCI peripheral on MSP432 using the micro DMA controller. </p>
<hr/>
<p>The SPI header file should be included in an application as follows: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_s_p_i_8h.html">ti/drivers/SPI.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_s_p_i_m_s_p432_d_m_a_8h.html">ti/drivers/spi/SPIMSP432DMA.h</a>&gt;</span></div></div><!-- fragment --><p>Refer to <a class="el" href="_s_p_i_8h.html">SPI.h</a> for a complete description of APIs &amp; example of use.</p>
<p>This SPI driver implementation is designed to operate on a EUCSI controller in SPI mode using a micro DMA controller.</p>
<dl class="section warning"><dt>Warning</dt><dd>This driver does not support queueing multiple SPI transactions.</dd></dl>
<h2>Frame Formats</h2>
<p>This SPI controller supports 4 phase &amp; polarity formats. Refer to the device specific data sheets &amp; technical reference manuals for specifics on each format.</p>
<h2>SPI Chip Select</h2>
<p>The SPI driver can be used in 3-pin or 4-pin mode. When in 4-pin mode the hardware manages a pin as the chip select. In 3-pin mode it is the application's responsibility to assert and de-assert a GPIO pin for chip select purposes.</p>
<table class="doxtable">
<tr>
<th>Chip select type </th><th>SPI_MASTER mode </th><th>SPI_SLAVE mode  </th></tr>
<tr>
<td>Hardware chip select </td><td>No action is needed by the application to select the peripheral. </td><td>See the device documentation on it's chip select requirements.  </td></tr>
<tr>
<td>Software chip select </td><td>The application is responsible to ensure that correct SPI slave is selected before performing a <a class="el" href="_s_p_i_8h.html#a989e17f96b54fcc3dc2cac5f8ac6bdb2" title="Function to perform SPI transactions. ">SPI_transfer()</a>. </td><td>Up to the application's implementation.  </td></tr>
</table>
<h2>SPI data frames</h2>
<p>The EUSCI controller only supports 8-bit data frames.</p>
<table class="doxtable">
<tr>
<th>dataSize </th><th>buffer element size  </th></tr>
<tr>
<td>8 bits </td><td>uint8_t </td></tr>
</table>
<h2>DMA operation</h2>
<p>DMA use in this driver varies based on the <a class="el" href="_s_p_i_8h.html#ab9ea76c6529d6076eee5e1c4a5a92c6f" title="SPI transfer mode determines the whether the SPI controller operates synchronously or asynchronously...">SPI_TransferMode</a> set when the driver instance was opened. If the driver was opened in <a class="el" href="_s_p_i_8h.html#ab9ea76c6529d6076eee5e1c4a5a92c6fa5631e69925c47a62a261c78ebbda39fb">SPI_MODE_CALLBACK</a>, all transfers make use of the DMA regardless of the amount of data.</p>
<p>If the driver was opened in <a class="el" href="_s_p_i_8h.html#ab9ea76c6529d6076eee5e1c4a5a92c6fa0dfb2358e008316426895e7237c398e8">SPI_MODE_BLOCKING</a>, it verifies the amount of data frames to be transfered exceeds the SPIMSP432DMA_HwAttrsV1.minDmaTransferSize before performing a transfer using the DMA. SPIMSP432DMA_HwAttrsV1.minDmaTransferSize allows users to set a minimum amount of data frames a transfer must have to perform a transfer using the DMA. If the amount of data is less than this limit, the driver performs a polling transfer (unless the device is a slave with a timeout configured). This feature is provided for situations where there is little data to be transfered &amp; it is more efficient to simply perform a polling transfer instead of configuring the DMA &amp; waiting until the task is unblocked.</p>
<h2>DMA Interrupts</h2>
<p>The MSP432 DMA controller has 4 interrupt vectors to handle all DMA related IRQ. Due to the "shared" nature of the DMA interrupts, this driver implementation requires each SPI instance to explicitly use a single DMA interrupt. It is up to the application to ensure no two peripherals are configured to respond to a given DMA interrupt at any moment.</p>
<h2>DMA transfer size limit</h2>
<p>The DMA controller only supports data transfers of up to 1024 data frames, so large amounts of data will be split &amp; transfered accordingly. Each SPI driver instance requires 2 DMA channels (Tx and Rx) to operate.</p>
<h2>DMA accessible memory</h2>
<p>Ensure that the <a class="el" href="struct_s_p_i___transaction.html#a214f57d7809c875fb9456a62a406e041">SPI_Transaction.rxBuf</a> and <a class="el" href="struct_s_p_i___transaction.html#a9461a248f1cceb4048668d44b323a0b8">SPI_Transaction.txBuf</a> point to memory that is accessible by the DMA.</p>
<h2>Scratch Buffers</h2>
<p>A uint8_t scratch buffer is used to allow <a class="el" href="struct_s_p_i___transaction.html" title="A SPI_Transaction data structure is used with SPI_transfer(). It indicates how many SPI_FrameFormat f...">SPI_Transaction</a> where txBuf or rxBuf are NULL. Rather than requiring txBuf or rxBuf to have a dummy buffer of size of the transfer count, a single DMA accessible uint8_t scratch buffer is used. When txBuf is NULL, an internal scratch buffer is initialized to the SPIMSP432DMA_HwAttrsV1.defaultTxBufValue so the DMA will send some known value. </p><hr/>
</div><div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;ti/devices/DeviceFamily.h&gt;</code><br />
<code>#include &lt;ti/drivers/dpl/HwiP.h&gt;</code><br />
<code>#include &lt;ti/drivers/dpl/SemaphoreP.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_power_8h_source.html">ti/drivers/Power.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_s_p_i_8h_source.html">ti/drivers/SPI.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_u_d_m_a_m_s_p432_8h_source.html">ti/drivers/dma/UDMAMSP432.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for SPIMSP432DMA.h:</div>
<div class="dyncontent">
<div class="center"><img src="_s_p_i_m_s_p432_d_m_a_8h__incl.png" border="0" usemap="#_s_p_i_m_s_p432_d_m_a_8h" alt=""/></div>
<map name="_s_p_i_m_s_p432_d_m_a_8h" id="_s_p_i_m_s_p432_d_m_a_8h">
<area shape="rect" id="node6" href="_power_8h.html" title="Power Manager. " alt="" coords="47,80,171,107"/>
<area shape="rect" id="node10" href="_s_p_i_8h.html" title="Serial Peripheral Interface (SPI) Driver Interface. " alt="" coords="203,155,313,181"/>
<area shape="rect" id="node11" href="_u_d_m_a_m_s_p432_8h.html" title="uDMA driver implementation for MSP432. " alt="" coords="247,80,453,107"/>
<area shape="rect" id="node7" href="_list_8h.html" title="Linked List interface for use in drivers. " alt="" coords="43,155,179,181"/>
</map>
</div>
</div>
<p><a href="_s_p_i_m_s_p432_d_m_a_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_p_i_m_s_p432_d_m_a___h_w_attrs_v1.html">SPIMSP432DMA_HWAttrsV1</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPIMSP432DMA Hardware attributes These fields, with the exception of intPriority, are used by driverlib APIs and therefore must be populated by driverlib macro definitions. For MSP432 driverlib these definitions are found in:  <a href="struct_s_p_i_m_s_p432_d_m_a___h_w_attrs_v1.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_p_i_m_s_p432_d_m_a___object.html">SPIMSP432DMA_Object</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPIMSP432DMA Object.  <a href="struct_s_p_i_m_s_p432_d_m_a___object.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7d33a0422c0eda3f15f38e7fa62a64c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_p_i_m_s_p432_d_m_a_8h.html#a7d33a0422c0eda3f15f38e7fa62a64c4">SPIMSP432DMA_PIN_NO_CONFIG</a>&#160;&#160;&#160;(0x0000FFFF)</td></tr>
<tr class="memdesc:a7d33a0422c0eda3f15f38e7fa62a64c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPIMSP432DMA_PIN_NO_CONFIG can be used to inform the SPIMSP432DMA driver that a pin should not be configured for use in the SPI bus. If the simoPin, somiPin or stePin is set to SPIMSP432DMA_PIN_NO_CONFIG in the SPIMSP432DMA_HWAttrs, the pin is not configured to SPI functionality during <a class="el" href="_s_p_i_8h.html#a9c9022decfb136991d6b53f7dd2ae2fc" title="This function opens a given SPI peripheral. ">SPI_open()</a> and the pin can be used for another function. The clkPin cannot be set to SPIMSP432DMA_PIN_NO_CONFIG; the clock signal is always required during communication &amp; must be driven by the SPI bus master.  <a href="#a7d33a0422c0eda3f15f38e7fa62a64c4">More...</a><br /></td></tr>
<tr class="separator:a7d33a0422c0eda3f15f38e7fa62a64c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a0fe3f3e8b44accb489d129aea007bfc3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_s_p_i_m_s_p432_d_m_a___object.html">SPIMSP432DMA_Object</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_p_i_m_s_p432_d_m_a_8h.html#a0fe3f3e8b44accb489d129aea007bfc3">SPIMSP432DMA_Handle</a></td></tr>
<tr class="separator:a0fe3f3e8b44accb489d129aea007bfc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aee524b32bcdc37f4035099dff00abbc2"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="struct_s_p_i___fxn_table.html">SPI_FxnTable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_p_i_m_s_p432_d_m_a_8h.html#aee524b32bcdc37f4035099dff00abbc2">SPIMSP432DMA_fxnTable</a></td></tr>
<tr class="separator:aee524b32bcdc37f4035099dff00abbc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7d33a0422c0eda3f15f38e7fa62a64c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d33a0422c0eda3f15f38e7fa62a64c4">&sect;&nbsp;</a></span>SPIMSP432DMA_PIN_NO_CONFIG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPIMSP432DMA_PIN_NO_CONFIG&#160;&#160;&#160;(0x0000FFFF)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SPIMSP432DMA_PIN_NO_CONFIG can be used to inform the SPIMSP432DMA driver that a pin should not be configured for use in the SPI bus. If the simoPin, somiPin or stePin is set to SPIMSP432DMA_PIN_NO_CONFIG in the SPIMSP432DMA_HWAttrs, the pin is not configured to SPI functionality during <a class="el" href="_s_p_i_8h.html#a9c9022decfb136991d6b53f7dd2ae2fc" title="This function opens a given SPI peripheral. ">SPI_open()</a> and the pin can be used for another function. The clkPin cannot be set to SPIMSP432DMA_PIN_NO_CONFIG; the clock signal is always required during communication &amp; must be driven by the SPI bus master. </p>
<p>Prevent all these port defines from cluttering doxygen</p>
<p>Setting pins to SPIMSP432DMA_PIN_NO_CONFIG can be useful in the following situations:</p><ol type="1">
<li>simoPin = SPIMSP432DMA_PIN_NO_CONFIG: Useful in situations where the master will not transmit meaningful data but is interested in receiving data from slaves. Slaves must ignore incoming data from master.</li>
<li>somiPin = SPIMSP432DMA_PIN_NO_CONFIG: Useful in situations where the SPI bus master will transmit data to the slaves &amp; is not interested in the data returned by the slaves.</li>
<li>stePin = SPIMSP432DMA_PIN_NO_CONFIG: Useful in situations the ste (chip select) pin will be handled by the application instead of automatically by the hardware. This is useful when the SPI master has to communicate with multiple slaves. </li>
</ol>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a0fe3f3e8b44accb489d129aea007bfc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe3f3e8b44accb489d129aea007bfc3">&sect;&nbsp;</a></span>SPIMSP432DMA_Handle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef  struct <a class="el" href="struct_s_p_i_m_s_p432_d_m_a___object.html">SPIMSP432DMA_Object</a> * <a class="el" href="_s_p_i_m_s_p432_d_m_a_8h.html#a0fe3f3e8b44accb489d129aea007bfc3">SPIMSP432DMA_Handle</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aee524b32bcdc37f4035099dff00abbc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee524b32bcdc37f4035099dff00abbc2">&sect;&nbsp;</a></span>SPIMSP432DMA_fxnTable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="struct_s_p_i___fxn_table.html">SPI_FxnTable</a> SPIMSP432DMA_fxnTable</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><small>
  <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2019</a>, Texas Instruments Incorporated. All rights reserved. <br>
  <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>
</small>
</body>
</html>
